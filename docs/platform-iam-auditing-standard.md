Platform IAM Auditing Standard
Version: 1.0 Status: Published Last Updated: September 6, 2025
1. Overview & Vision
This document defines the specification for the platform's Automated Least-Privilege IAM Auditing standard. The primary challenge in maintaining a secure cloud environment is "privilege creep," where IAM roles accumulate permissions over time that are no longer actively used, increasing the potential blast radius of a security incident.
The vision of this standard is to provide a data-driven, automated tool that makes the verification and right-sizing of IAM permissions a routine, evidence-based practice. By comparing the permissions granted to a service with the permissions it has actually used, we can systematically identify and eliminate over-provisioned access, ensuring all services adhere to the principle of least privilege.
2. Guiding Principles
Data-Driven: All recommendations MUST be based on historical usage data from AWS CloudTrail, which serves as the definitive ground truth for all API actions performed by an IAM principal.
Actionable & Clear: The audit output MUST be clear, concise, and provide an actionable path toward remediation. It should distinguish between used and unused permissions and identify the source of the granted permissions.
Non-Intrusive: The audit process MUST be a read-only operation. It has no impact on the performance or availability of running services.
Safe by Default: The tool MUST only recommend changes. It MUST NOT have the ability to automatically modify IAM policies. Remediation is a deliberate, human-in-the-loop action, typically involving a version-controlled code change.
3. Architectural Implementation
The IAM audit capability is implemented as a new command in our CLI (svc audit iam) and is supported by the platform's backend services.
Data Source (Ground Truth): AWS CloudTrail is the authoritative source for API usage. The platform MUST ensure that CloudTrail is enabled in all managed accounts via the "Platform Baseline" stack.
Data Analysis Engine: The platform's backend (likely within the MCP Server) provides an internal service for analyzing usage data. For performance, this service will query CloudTrail logs via Amazon Athena.
Desired State Source: The "granted" permissions are determined by synthesizing a service's manifest (service.yml) and inspecting the IAM policies generated by the platform's Binder Strategies.
Comparison Logic: The core of the feature is a comparison of two sets of IAM actions for a given IAM role:
Granted Permissions: The set of all actions allowed by the role's IAM policies.
Used Permissions: The distinct set of actions performed by the role within a specified time window, as recorded by CloudTrail.
Unused Permissions: The result of Granted - Used.
4. The svc audit iam Command Specification
This new CLI command is the primary user interface for the IAM Auditing standard.
Command: svc audit iam
Arguments:
--service <service-name>: (Required) The name of the service to audit.
--component <component-name>: (Required) The name of the component within the service whose IAM role should be audited (e.g., api, worker).
Options:
--since <days>: The number of days of historical data to analyze. Defaults to 90.
--output <format>: The output format. Defaults to human. Can be json or markdown.
--ci: A flag for CI/CD environments that enables non-interactive, machine-readable output.
Command Workflow
The user runs svc audit iam --service order-api --component api --since 30.
The CLI synthesizes the order-api service manifest to determine the full set of Granted Permissions for the api component's IAM role.
The CLI calls the platform's backend (e.g., the MCP Server's GET /admin/iam-usage endpoint), passing the role's ARN and the 30-day time window.
The backend service executes an Athena query against the CloudTrail logs to get the distinct list of Used Permissions.
The CLI receives both sets, performs the comparison, and formats the results according to the --output flag.
Output Example (human format)
IAM Audit Report for service 'order-api', component 'api'
Analyzing usage data from the last 30 days...

Role: arn:aws:iam::123456789012:role/order-api-api-role-ABC123

[âœ“] USED PERMISSIONS (3)
------------------------------------------------------------------
Permission                          Granted By
----------------------------------- --------------------------------
sqs:SendMessage                     Binding to 'processing-queue'
secretsmanager:GetSecretValue       Binding to 'app-database'
s3:GetObject                        Binding to 'documents-bucket'

[!] UNUSED PERMISSIONS (2)
------------------------------------------------------------------
Permission                          Granted By
----------------------------------- --------------------------------
s3:PutObject                        Binding to 'documents-bucket'
s3:DeleteObject                     Binding to 'documents-bucket'

Recommendation: The 'readwrite' access level for the binding to 'documents-bucket'
may be too permissive. Consider changing to 'read' access in the service.yml manifest.


